{{ $normal_flavors := site.Data.flavors.normal }}
<link rel="stylesheet" href="/css/form.css">
<!--Take over form response redirect back to our page-->
<script type="text/javascript">var submitted=false;</script>
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted) {window.location='/thank-you';}"></iframe>

<form action="https://docs.google.com/forms/u/0/d/1JP8MowapEqTrKUy-1fPiuhUk9S20RSR0LxnipaUsPuM/formResponse" method="post" target="hidden_iframe" onsubmit="submitted=true">
<label>Your Email*</label>
<input type="email" class="form-input" name="entry.1295339816" required>
    <fieldset>
        <legend>Choose Your Flavors:</legend>
        {{ range $normal_flavors }}
            <div class="form-row">
                <label class="form-label" for="{{ .value }}">{{ .name }}</label>
                <div class="input-with-unit">
                <input 
                    class="form-input"
                    type="number" 
                    id="dozens-{{ .value }}" 
                    name="{{ .value }}" 
                    min="0" 
                    value="0"
                >
                <span class="unit">dozen</span>
                </div>
            </div>
        {{ end }}
    </fieldset>
   <button type="submit">Send</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const dropdowns = document.querySelectorAll('.flavor-dropdown');

    dropdowns.forEach(dropdown => {
        dropdown.addEventListener('change', () => {
            // Get all selected values
            const selectedValues = Array.from(dropdowns)
                .map(dd => dd.value)
                .filter(value => value !== '');

            // Update options in all dropdowns
            dropdowns.forEach(dd => {
                Array.from(dd.options).forEach(option => {
                    if (option.value === '') {
                        // Always keep the "None" option available
                        option.disabled = false;
                    } else {
                        // Disable options already selected in other dropdowns
                        option.disabled = selectedValues.includes(option.value) && dd.value !== option.value;
                    }
                });
            });
        });
    });
});
</script>