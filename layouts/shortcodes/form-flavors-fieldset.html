{{ $flavors := site.Data.flavors.normal }}
<link rel="stylesheet" href="/css/form.css">
<form action="https://docs.google.com/forms/d/e/<formID/formResponse" method="post" target="hidden_iframe" onsubmit="submitted=true">
<label>Email*</label>
<input type="email" placeholder="Email address*" class="form-input" name="entry.1119409224" required>
<fieldset>
    <legend>Choose Your Flavors:</legend>
    {{ range $index, $flavor := $flavors }}
        <div>
            <label for="flavor{{ add $index 1 }}">Flavor {{ add $index 1 }}:</label>
            <select class="flavor-dropdown" id="flavor{{ add $index 1 }}" name="flavor{{ add $index 1 }}">
                <option value="">None</option>
                {{ range $flavors }}
                    <option value="{{ .value }}">{{ .name }}</option>
                {{ end }}
            </select>
            <label for="dozen{{ add $index 1 }}">Dozens:</label>
            <input type="number" id="dozen{{ add $index 1 }}" name="dozen{{ add $index 1 }}" min="0" max="10" value="0">
        </div>
    {{ end }}
</fieldset>
   <button type="submit">Send</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const dropdowns = document.querySelectorAll('.flavor-dropdown');

    dropdowns.forEach(dropdown => {
        dropdown.addEventListener('change', () => {
            // Get all selected values
            const selectedValues = Array.from(dropdowns)
                .map(dd => dd.value)
                .filter(value => value !== '');

            // Update options in all dropdowns
            dropdowns.forEach(dd => {
                Array.from(dd.options).forEach(option => {
                    if (option.value === '') {
                        // Always keep the "None" option available
                        option.disabled = false;
                    } else {
                        // Disable options already selected in other dropdowns
                        option.disabled = selectedValues.includes(option.value) && dd.value !== option.value;
                    }
                });
            });
        });
    });
});
</script>